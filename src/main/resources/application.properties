spring.config.import=optional:file:.env[.properties]

spring.application.name=lilyoutube_server

management.endpoints.web.exposure.include=health,info,prometheus
management.metrics.tags.application=${spring.application.name}
management.metrics.distribution.percentiles-histogram.http.server.requests=true
management.metrics.distribution.sla.http.server.requests=100ms, 500ms

# Primary datasource - shared database
spring.datasource.url=jdbc:postgresql://${DATABASE_HOST:localhost}:${DATABASE_PORT:5432}/${DATABASE_NAME:lilyoutube-v1}
spring.datasource.username=${DATABASE_USERNAME:postgres}
spring.datasource.password=${DATABASE_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver
spring.datasource.hikari.pool-name=HikariPool-1
spring.datasource.hikari.register-mbeans=true
management.metrics.enable.hikaricp=true

management.endpoints.web.exposure.include=*

# Secondary datasource - metrics database (replica-specific)
spring.data.redis.host=${SPRING_DATA_REDIS_HOST:localhost}
spring.data.redis.port=${SPRING_DATA_REDIS_PORT:6379}
app.replica-name=${REPLICA_NAME:local}
app.peer-urls=${PEER_URLS:}
app.sync.rate-ms=10000
app.sync.db-rate-ms=30000


server.port=${SERVER_PORT:8080}
spring.liquibase.change-log=classpath:/changelog/db.changelog-master.xml

spring.jpa.hibernate.ddl-auto=update

app.base-url=http://localhost:${server.port}

spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${MY_EMAIL_ADDRESS}
spring.mail.password=${MY_APP_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

spring.servlet.multipart.max-file-size=200MB
spring.servlet.multipart.max-request-size=200MB

app.upload.timeout-ms=60000

server.tomcat.connection-timeout=60000
spring.mvc.async.request-timeout=60000
server.tomcat.keep-alive-timeout=60000

server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.directory=/dev
server.tomcat.accesslog.prefix=stdout
server.tomcat.accesslog.suffix=
server.tomcat.accesslog.file-date-format=
# Optional: Customize the log pattern (standard pattern shown)
server.tomcat.accesslog.pattern=%t %a "%r" %s (%D ms)
